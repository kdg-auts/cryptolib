A0 = 0x00000000
B0 = 0x00000000
#K = 0x733D2C20656865737474676979676120626E737320657369326C656833206D54
K1 = [0x33206D54, 0x326C6568, 0x20657369, 0x626E7373, 0x79676120, 0x74746769, 0x65686573, 0x733D2C20 ]

SB = ((0x4, 0xA, 0x9, 0x2, 0xD, 0x8, 0x0, 0xE, 0x6, 0xB, 0x1, 0xC, 0x7, 0xF, 0x5, 0x3),
      (0xE, 0xB, 0x4, 0xC, 0x6, 0xD, 0xF, 0xA, 0x2, 0x3, 0x8, 0x1, 0x0, 0x7, 0x5, 0x9),
      (0x5, 0x8, 0x1, 0xD, 0xA, 0x3, 0x4, 0x2, 0xE, 0xF, 0xC, 0x7, 0x6, 0x0, 0x9, 0xB),
      (0x7, 0xD, 0xA, 0x1, 0x0, 0x8, 0x9, 0xF, 0xE, 0x4, 0x6, 0xC, 0xB, 0x2, 0x5, 0x3),
      (0x6, 0xC, 0x7, 0x1, 0x5, 0xF, 0xD, 0x8, 0x4, 0xA, 0x9, 0xE, 0x0, 0x3, 0xB, 0x2),
      (0x4, 0xB, 0xA, 0x0, 0x7, 0x2, 0x1, 0xD, 0x3, 0x6, 0x8, 0x5, 0x9, 0xC, 0xF, 0xE),
      (0xD, 0xB, 0x4, 0x1, 0x3, 0xF, 0x5, 0x9, 0x0, 0xA, 0xE, 0x7, 0x6, 0x8, 0x2, 0xC),
      (0x1, 0xF, 0xD, 0x0, 0x5, 0x7, 0xA, 0x4, 0x9, 0x2, 0x3, 0xE, 0x6, 0xB, 0x8, 0xC))

print("A0:", format(A0, '08x'), "B0:", format(B0, '08x'), "K0:", format(K1[0], '08x'))

# one round
A1 = (A0 + K1[0]) & 0xFFFFFFFF
print("SM:", format(A1, '08x'))
T = 0
for i in range(8):
    T |= ((SB[i][(A1 >> (4 * i)) & 0b1111]) << (4 * i))
A1 = T
print("SB:", format(A1, '08x'))
A1 = (A1>>21) | ((A1<<11)&(2**31-1))
print("RT:", format(A1, '08x'))
A1 = A1 ^ B0
B1 = A0
print("A1:", format(A1, '08x'), "B1:", format(B1, '08x'), "K1:", format(K1[1], '08x'))